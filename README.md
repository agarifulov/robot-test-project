## Отчет по выполнению тестового задания

Автотест был реализован c использованием Python 2.7 и Robot Framework 3.0.2

### Состав решения:
* libraries - библиотеки на python
* tests - папка с тестом
* resources - файл с кейвордами на robot framework
* results - отчет, полученный в хрде выполнения теста

### Для запуска необходимо:
* Python 2.7
* установить зависимости при промощи команды:

$ pip install -r requirements.txt

* собрать и запустить docker:

$ docker-compose build

$ docker-compose up

* запустить автотест

$ robot -d report tests

### Bug report: Проблема тестового окружения: в БД не изменяются данные при подключении услуги

*Severity*: Critical

*Priority*: High

*Summary:*

В базу данных не записываются изменения баланса клиента при подключении ему услуги.

*Steps:*
1. Клиент с client_id = 1 и положительным балансом client_balance = 5.0 был выбран из БД, либо создан. Зафиксирован его начальный баланс.
2. Была найдена и зафиксирована услуга service_id = 1 со стоимостью cost = 1.2, доступная для подключения выбранному клиенту.
3. Данная услуга была подключена выбранному клиенту.
4. Было произведено сравнение ожидаемого конечного баланса 3.8 с полученным из БД фактическим балансом выбранного клиента 5.0.

*Expected Result:*

Ожидаемый баланс client_balance = 3.8 равен конечному.

*Result:*

Ожидаемый баланс client_balance = 3.8, а конечный client_balance = 5.0

### Вариант решения проблемы, описанной в Bug report

В данной реализации проблема была решена доработкой тестового окружения. Вместо копирования AUT в docker было произведено монтирование.
Технически это не лучшее решение, т.к. возможен конкурентный доступ к файлу БД из AUT и автотестов (в будущем, при расширении).
В качестве альтернативы можно предложить доработку AUT для обеспечения возможности создания тестовых данных через API.

### Примечание

В случае использования для теста клиента с положительным балансом, но полным списком подключенных услуг, тест упадет с ошибкой.
Во избежание подобной ситуации лучше не использовать готовые тестовые данные, а создавать их перед каждым прогоном, после выполнения теста - удалять.
В данном случае можно было бы создавать нового клиента после ошибки на шаге получения доступной для подключения услуги, либо отключать выбранному клиенту какую-то из услуг, но это делает тест сложным в плане логики и восприятия.


